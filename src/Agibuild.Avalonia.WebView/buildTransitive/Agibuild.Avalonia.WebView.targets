<Project>
  <PropertyGroup>
    <!--
      WebView2 dependency resolution:
      - This package ships the Windows adapter assembly, which depends on Microsoft.Web.WebView2.Core at runtime.
      - Microsoft.Web.WebView2 does not reliably flow compile references transitively without its build targets.
      - To keep host projects free from WebView2 build/buildTransitive injection while still ensuring the required
        runtime assembly is present, we add an explicit reference to WebView2.Core on Windows.
    -->
    <AgibuildWebView_WebView2PackageVersion>1.0.3719.77</AgibuildWebView_WebView2PackageVersion>
  </PropertyGroup>

  <ItemGroup Condition="$([MSBuild]::IsOSPlatform('windows'))">
    <Reference Include="Microsoft.Web.WebView2.Core">
      <HintPath>$(NuGetPackageRoot)microsoft.web.webview2\$(AgibuildWebView_WebView2PackageVersion)\lib_manual\netcoreapp3.0\Microsoft.Web.WebView2.Core.dll</HintPath>
      <Private>true</Private>
    </Reference>
  </ItemGroup>

  <!--
    Ensure dynamically-loaded adapter assemblies aren't trimmed away.
    All managed adapters ship in lib/net10.0/ alongside the core DLLs.
    Module initializers register the correct adapter at runtime; the linker would
    otherwise remove "unused" adapters during publish trimming.
  -->
  <ItemGroup Condition="'$(PublishTrimmed)' == 'true'">
    <TrimmerRootAssembly Include="Agibuild.Avalonia.WebView.Adapters.MacOS" />
    <TrimmerRootAssembly Include="Agibuild.Avalonia.WebView.Adapters.Windows" />
    <TrimmerRootAssembly Include="Agibuild.Avalonia.WebView.Adapters.Gtk" />
    <TrimmerRootAssembly Include="Agibuild.Avalonia.WebView.Adapters.Android"
                         Condition="$([System.String]::Copy('$(RuntimeIdentifier)').StartsWith('android'))" />
  </ItemGroup>
</Project>
