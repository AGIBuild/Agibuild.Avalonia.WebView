<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:Agibuild.Avalonia.WebView.Integration.Tests.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1024" d:DesignHeight="640"
             x:Class="Agibuild.Avalonia.WebView.Integration.Tests.Views.MainView"
             x:DataType="vm:MainViewModel">
  <Design.DataContext>
    <vm:MainViewModel />
  </Design.DataContext>

  <DockPanel Background="{StaticResource SurfaceBgBrush}">

    <!-- ════════════ Desktop: Top Header Bar with Hamburger ════════════ -->
    <Border DockPanel.Dock="Top" Height="42"
            IsVisible="{Binding !IsMobile}">
      <Border.Background>
        <LinearGradientBrush StartPoint="0%,50%" EndPoint="100%,50%">
          <GradientStop Color="#1E40AF" Offset="0" />
          <GradientStop Color="#2563EB" Offset="0.5" />
          <GradientStop Color="#0EA5E9" Offset="1" />
        </LinearGradientBrush>
      </Border.Background>
      <Grid ColumnDefinitions="Auto,Auto,*,Auto" Margin="6,0,10,0">
        <!-- Hamburger toggle -->
        <ToggleButton x:Name="NavToggle" Grid.Column="0"
                      Content="&#x2630;" FontSize="16"
                      Foreground="White" Background="Transparent"
                      BorderThickness="0" Padding="8,4"
                      VerticalAlignment="Center" CornerRadius="6" />
        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8"
                    VerticalAlignment="Center" Margin="4,0,0,0">
          <TextBlock Text="Agibuild WebView" FontSize="15" FontWeight="Bold"
                     Foreground="White" VerticalAlignment="Center" />
        </StackPanel>
        <Border Grid.Column="3" Background="#30FFFFFF" CornerRadius="10"
                Padding="8,3" VerticalAlignment="Center">
          <TextBlock Text="E2E Test" FontSize="10" FontWeight="SemiBold"
                     Foreground="White" />
        </Border>
      </Grid>
    </Border>

    <!-- ════════════ Mobile: Bottom Tab Bar ════════════ -->
    <Border DockPanel.Dock="Bottom"
            IsVisible="{Binding IsMobile}"
            Height="56" Background="White"
            BorderThickness="0,1,0,0" BorderBrush="{StaticResource BorderDefaultBrush}">
      <UniformGrid Columns="5">
        <Button Classes="tab-item"
                Command="{Binding SelectTab0Command}"
                Tag="{Binding SelectedTabIndex}">
          <StackPanel Spacing="2" HorizontalAlignment="Center">
            <TextBlock Text="&#x25CE;" FontSize="20" HorizontalAlignment="Center" />
            <TextBlock Text="Browser" Classes="tab-label" HorizontalAlignment="Center" />
          </StackPanel>
        </Button>
        <Button Classes="tab-item"
                Command="{Binding SelectTab1Command}"
                Tag="{Binding SelectedTabIndex}">
          <StackPanel Spacing="2" HorizontalAlignment="Center">
            <TextBlock Text="&#x25C6;" FontSize="20" HorizontalAlignment="Center" />
            <TextBlock Text="Advanced" Classes="tab-label" HorizontalAlignment="Center" />
          </StackPanel>
        </Button>
        <Button Classes="tab-item"
                Command="{Binding SelectTab2Command}"
                Tag="{Binding SelectedTabIndex}">
          <StackPanel Spacing="2" HorizontalAlignment="Center">
            <TextBlock Text="&#x25C9;" FontSize="20" HorizontalAlignment="Center" />
            <TextBlock Text="Smoke" Classes="tab-label" HorizontalAlignment="Center" />
          </StackPanel>
        </Button>
        <Button Classes="tab-item"
                Command="{Binding SelectTab3Command}"
                Tag="{Binding SelectedTabIndex}">
          <StackPanel Spacing="2" HorizontalAlignment="Center">
            <TextBlock Text="&#x2713;" FontSize="20" HorizontalAlignment="Center" />
            <TextBlock Text="Feature" Classes="tab-label" HorizontalAlignment="Center" />
          </StackPanel>
        </Button>
        <Button Classes="tab-item"
                Command="{Binding SelectTab4Command}"
                Tag="{Binding SelectedTabIndex}">
          <StackPanel Spacing="2" HorizontalAlignment="Center">
            <TextBlock Text="&#x2261;" FontSize="20" HorizontalAlignment="Center" />
            <TextBlock Text="Console" Classes="tab-label" HorizontalAlignment="Center" />
          </StackPanel>
        </Button>
      </UniformGrid>
    </Border>

    <!-- ════════════ Desktop: Push Drawer (left-docked, toggled by hamburger) ════════════ -->
    <Border DockPanel.Dock="Left" Width="170"
            IsVisible="{Binding #NavToggle.IsChecked}"
            Background="White"
            BorderThickness="0,0,1,0" BorderBrush="{StaticResource BorderDefaultBrush}">
      <DockPanel>
        <TextBlock DockPanel.Dock="Top" Text="Modules" Classes="caption"
                   Margin="12,10,12,4" />
        <ListBox x:Name="NavList"
                 SelectedIndex="{Binding SelectedTabIndex}"
                 SelectionChanged="OnNavSelectionChanged"
                 Background="Transparent" Margin="6,2">
          <ListBox.Styles>
            <Style Selector="ListBoxItem">
              <Setter Property="CornerRadius" Value="8" />
              <Setter Property="Padding" Value="12,8" />
              <Setter Property="Margin" Value="0,1" />
              <Setter Property="FontSize" Value="12" />
            </Style>
          </ListBox.Styles>
          <ListBoxItem Content="Browser" />
          <ListBoxItem Content="Advanced" />
          <ListBoxItem Content="Smoke" />
          <ListBoxItem Content="Feature E2E" />
          <ListBoxItem Content="Console" />
        </ListBox>
      </DockPanel>
    </Border>

    <!-- ════════════ Page Host: stacked pages with visibility toggle ════════════ -->
    <!--
      All page views are added as children of this Grid and kept alive.
      Only the selected page is visible.  This prevents NativeControlHost
      from detaching/disposing native WebView handles on tab switch.
    -->
    <Grid x:Name="PageHost" />

  </DockPanel>
</UserControl>
