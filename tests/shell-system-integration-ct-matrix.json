{
  "version": 1,
  "rows": [
    {
      "id": "tray-event-inbound",
      "coverage": ["allow", "deny", "failure"],
      "evidence": [
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Inbound_system_integration_events_are_delivered_only_when_policy_allows"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Denied_inbound_system_integration_event_never_reaches_dispatch_subscribers"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Invalid_inbound_tray_metadata_is_denied_before_web_delivery"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Invalid_inbound_system_integration_metadata_is_denied_before_policy_and_dispatch"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Over_budget_inbound_system_integration_metadata_is_denied_before_policy_and_dispatch"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Inbound_metadata_budget_uses_configured_in_range_value_deterministically"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Inbound_metadata_budget_configuration_outside_bounds_is_rejected_deterministically"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Over_budget_inbound_tray_metadata_is_denied_before_web_delivery"
        }
      ]
    },
    {
      "id": "menu-pruning",
      "coverage": ["allow", "deny", "failure"],
      "evidence": [
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Menu_pruning_policy_is_deterministic_and_denied_pruning_does_not_mutate_effective_menu_state"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Profile_denied_menu_pruning_short_circuits_policy_stage_and_preserves_state"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Profile_allow_then_policy_deny_keeps_previous_effective_menu_state"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Profile_revision_metadata_is_optional_and_emits_stable_null_fields"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Menu_pruning_profile_failure_is_isolated_from_permission_download_and_new_window_domains"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.Integration.Tests.Automation/HostCapabilityBridgeIntegrationTests.cs",
          "testMethod": "Host_system_integration_event_roundtrip_and_menu_pruning_are_deterministic"
        }
      ]
    },
    {
      "id": "system-action-whitelist",
      "coverage": ["allow", "deny", "failure"],
      "evidence": [
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Non_whitelisted_system_action_is_denied_before_provider_execution"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "ShowAbout_system_action_executes_only_when_explicitly_allowlisted"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "ShowAbout_whitelist_allow_still_honors_policy_deny_before_provider_execution"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "System_action_provider_failure_is_reported_and_isolated_from_other_system_integration_operations"
        }
      ]
    },
    {
      "id": "tray-payload-v2-schema",
      "coverage": ["allow", "deny", "failure"],
      "evidence": [
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Missing_core_fields_are_denied_before_policy_and_dispatch"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/HostCapabilityBridgeTests.cs",
          "testMethod": "Non_platform_metadata_key_is_denied_before_policy_and_dispatch"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Non_platform_metadata_key_is_denied_before_web_delivery"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.UnitTests/ShellSystemIntegrationCapabilityTests.cs",
          "testMethod": "Invalid_tray_payload_v2_is_isolated_from_permission_download_and_new_window_domains"
        },
        {
          "file": "tests/Agibuild.Avalonia.WebView.Integration.Tests.Automation/HostCapabilityBridgeIntegrationTests.cs",
          "testMethod": "Tray_payload_v2_roundtrip_with_platform_extensions_is_machine_checkable"
        }
      ]
    }
  ]
}
